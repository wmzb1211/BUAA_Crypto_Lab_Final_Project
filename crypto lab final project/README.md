- [密码库](#密码库)
  - [math.py](#mathpy)
  - [SM2.py](#sm2py)
    - [sign签名函数](#sign签名函数)
    - [verify验证函数](#verify验证函数)
  - [SM3.py](#sm3py)
    - [hash\_sm3](#hash_sm3)
  - [SM4.py](#sm4py)
    - [SM4](#sm4)
    - [SM4\_CTR](#sm4_ctr)
    - [SM4\_CFB](#sm4_cfb)
  - [RSA.py](#rsapy)
    - [RSA encryption/decryption](#rsa-encryptiondecryption)
    - [RSA keygenerate](#rsa-keygenerate)
    - [RSA OAEP](#rsa-oaep)
  - [test.py](#testpy)

# 密码库
## math.py

​	实现了各种数学库,包含了判断质数、求最大公约数、扩展欧几里得算法、快速幂、求逆元、中国剩余定理、生成质数等函数。其中is_prime函数使用了Miller Rabin算法来判断一个数是否为质数。其他函数的功能可以从函数名和注释中看出来。

## SM2.py

### sign签名函数

​	Python类中的一个方法，名为sign。它接受五个参数：ID_A，P_A，M，d_A和k。它首先调用类中的另一个方法get_Z_A来获取Z_A值，然后将Z_A和M编码后的十六进制字符串拼接起来，使用SM3算法计算哈希值e。接下来，它使用椭圆曲线加密算法计算出$(x1, y1)$，然后使用$r = (e + x1) \% n$计算出$r$，再使用$s = (invmod(1 + d_A, n) * (k - r * d_A)) \% n$计算出$s$。最后，它返回$r$和$s$。

### verify验证函数

​	Python函数，名为verify，接受五个参数：ID_A，P_A，M，r和s。函数中使用了SM3哈希算法，对M进行哈希，并将结果与Z_A拼接后再进行哈希，得到e。接着，计算t、x1、y1、x2、y2、x和y，并计算R。最后，判断R是否等于r，如果是则返回True，否则返回False。

## SM3.py

### hash_sm3

​	SM3哈希函数的实现。它将输入的消息进行填充，然后使用迭代压缩算法进行哈希计算。其中，T是一个常量数组，Mlen表示消息的长度，temp是计算出的哈希值。

## SM4.py

### SM4

​	SM4加解密算法的实现，输入为一个128位的整数x，输出也是一个128位的整数。首先将x拆分成4个32位的整数，然后进行32轮迭代，每轮迭代都会进行一系列的操作，包括异或、S盒替换、线性变换等，最后得到加密或解密后的结果。具体的实现细节可以参考代码中的注释。

### SM4_CTR

​	SM4算法的CTR模式实现，用于文件的加密和解密。其中，file_path是文件路径，IV是初始化向量，MODE为1表示加密，0表示解密。代码中使用了一个CTR_get_key函数来生成密钥，然后对文件进行分块加密或解密。加密后的文件名为file_name.SM4_CTR。

### SM4_CFB

​	这段代码是一个SM4算法的实现，用于对文件进行加密和解密。它接受文件路径、初始向量、字节数和模式作为输入，输出加密或解密后的文件。在加密模式下，它将读取文件并将其分成n个字节的块，然后使用CFB模式对每个块进行加密。在解密模式下，它将读取加密后的文件并使用CFB模式对每个块进行解密。

## RSA.py

### RSA encryption/decryption

​	这是一个Python类中的两个方法，用于加密和解密数据。其中，encrypt方法接受一个参数m，使用类中的e_or_d和n属性对m进行加密，并返回加密后的结果。而decrypt方法接受一个参数c，使用类中的e_or_d和n属性对c进行解密，并返回解密后的结果。fastpower函数可能是一个用于快速幂运算的函数。

### RSA keygenerate

​	RSA加密算法的密钥生成函数。第一个函数根据给定的两个质数p和q生成公钥(e,n)，其中e是一个与(p-1)(q-1)互质的随机质数，d是e的模(p-1)(q-1)的逆元。第二个函数根据给定的位数N生成公钥(e,n)，其中p和q是N位的大质数。在两个函数中，都使用了一个invmod函数来计算模逆元。

### RSA OAEP

​	RSA算法的加密函数，使用OAEP填充方式。其中k表示RSA算法的安全参数，m表示明文，L表示标签，seed表示随机数。函数会先进行长度检查，然后使用EME_OAEP函数进行填充，最后进行加密并返回密文。

​	RSA加密算法中的OAEP解密函数。它接受三个参数：k表示密钥长度，c表示密文，L表示标签。函数首先计算出L的长度，然后根据密钥长度和标签长度检查密文长度是否合法。接着将密文转换为整数C，并检查C是否小于n。然后使用私钥解密C得到明文m，并将m转换为十六进制字符串EM。接着检查EM的长度是否合法，如果不合法则抛出异常。然后将EM填充到长度为2k的字符串中，并使用EME-OAEP解码算法解码得到明文M。最后将M转换为十六进制字符串并返回。

## test.py

​	对以上各种密码库的函数进行测试

